class Table
  constructor: ->
    @suits = ["spades","clubs","diamonds","hearts"]
    @values = [2..10].concat ["J","Q","K","A"]

    @allCards = []
    @unusedPile = new UnusedCardPile()
    @usedPile = new UsedCardPile()
    @playerHands = [
      new PlayerCardPile("player1", 0)
      new PlayerCardPile("player2", 1)
    ]
    @playerInventories = [
      new PlayerInventoryCardPile()
      new PlayerInventoryCardPile()
    ]

    for suit in @suits
      for value in @values
        card = new Card(value,suit)
        @allCards.push card
        @unusedPile.push card

    @unusedPile.shuffle()

  getSaveData: ->
    return {
      unusedPile: @unusedPile.getSaveData()
      usedPile: @usedPile.getSaveData()
      playerHands: [
        @playerHands[0].getSaveData()
        @playerHands[1].getSaveData()
      ]
    }

  loadData: (data) ->
    @allCards.length = 0

    @unusedPile.loadData data.unusedPile
    for card in @unusedPile.cards
      @allCards.push card

    @usedPile.loadData data.usedPile
    for card in @usedPile
      @allCards.push card


    for playerHand, i in @playerHands
      playerHand.loadData data.playerHands[i]
      for card in playerHand.cards
        @allCards.push card